<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Rexergy | Usage Habits</title>
    <!-- base:css -->
    <link rel="stylesheet" href="../../vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="../../vendors/css/vendor.bundle.base.css">
    <!-- endinject -->
    <!-- plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="../../css/style.css">
    <!-- endinject -->
    <link rel="shortcut icon" href="../../images/favicon.png"/>

    <!--jquery-->
    <script src="../../js/jquery-3.3.1.min.js" type="text/javascript" charset="utf-8"></script>

    <style>
        .user_bg {
            background-color: #01baef;
            background-image: linear-gradient(360deg, #01baef 0%, #20bf55 80%);
        }

    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>

    <!-- Plugin js for this page-->
    <script src="../../vendors/chart.js/Chart.min.js"></script>

</head>

<body>
<div class="adcenter"></div>
<div class="container-scroller d-flex">
    <!-- partial:./partials/_sidebar.html -->
    <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <ul class="nav">
            <li class="nav-item sidebar-category">
                <p>Navigation</p>
                <span></span>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../../dashboard.html">
                    <i class="mdi mdi-view-quilt menu-icon"></i>
                    <span class="menu-title">Dashboard</span>
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="habits.html">
                    <i class="mdi mdi-flash menu-icon"></i>
                    <span class="menu-title">Usage Habits</span>
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="recommend.html">
                    <i class="mdi mdi-star menu-icon"></i>
                    <span class="menu-title">Plan Recommend</span>
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="profile.html">
                    <i class="mdi mdi-account menu-icon"></i>
                    <span class="menu-title">User Profile</span>
                </a>
            </li>

        </ul>
    </nav>
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
        <!-- partial:./partials/_navbar.html -->
        <nav class="navbar col-lg-12 col-12 px-0 py-0 py-lg-4 d-flex flex-row">
            <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
                <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
                    <span class="mdi mdi-menu"></span>
                </button>
                <div class="navbar-brand-wrapper">
                    <a class="navbar-brand brand-logo" href="index.html"><img src="../../images/logo.svg"
                                                                              alt="logo"/></a>
                    <a class="navbar-brand brand-logo-mini" href="index.html"><img src="../../images/logo-mini.svg"
                                                                                   alt="logo"/></a>
                </div>
                <ul class="navbar-nav navbar-nav-right">

                </ul>
                <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button"
                        data-toggle="offcanvas">
                    <span class="mdi mdi-menu"></span>
                </button>
            </div>
            <div class="navbar-menu-wrapper navbar-search-wrapper d-none d-lg-flex align-items-center">
                <ul class="navbar-nav mr-lg-2">
                    <li class="nav-item nav-search d-none d-lg-block">
                        <h4 class="font-weight-bold mb-0 d-none d-md-block mt-1 text-black">Welcome back, Alex Xiu</h4>
                    </li>
                </ul>

            </div>
        </nav>
        <!-- partial -->
        <div class="main-panel">
            <div class="content-wrapper">
                <div class="row">
                    <div class="col-md-12 col-xl-12 grid-margin stretch-card">
                        <div class="row w-100 flex-grow">

                            <div class="col-md-4 grid-margin stretch-card">
                                <div class="card text-white">
                                    <div class="card-body user_bg">
                                        <div class="col-md-12" align="center">
                                            <img src="../../images/faces/face1.jpg" alt="image"/>
                                            <p class="display-4">Alex</p>
                                            <p>Platinum member</p>
                                        </div>
                                        <div class="py-4">
                                            <p class="clearfix">
                                                <span class="float-left"><i class="mdi mdi-city icon-md"></i> House Type </span>
                                                <span class="float-right" id="houseType"></span>
                                            </p>
                                            <p class="clearfix">
                                                <span class="float-left"><i class="mdi mdi-numeric icon-md"></i> Room No. </span>
                                                <span class="float-right" id="roomNumber"></span>
                                            </p>
                                            <p class="clearfix">
                                                <span class="float-left"><i
                                                        class="mdi mdi-map-marker-radius icon-md"></i> Address </span>
                                                <span class="float-right" id="address"></span>
                                            </p>

                                        </div>

                                    </div>
                                </div>
                            </div>

                            <div class="col-md-8 grid-margin stretch-card">
                                <div class="card">
                                    <div class="card-body pb-0">
                                        <div class="d-flex align-items-center py-4">
                                            <p class="card-title mb-0 mr-1">Current Energy Plan</p>
                                        </div>


                                        <script type="text/javascript">
                                            $(function () {

                                                // 实际使用的代码
                                                // var str = window.location.search;  //获取链接中传递的参数
                                                // var orderData = str.substring(str.indexOf("=") + 1);//?orderData={"roomNum":"210","orderDay":"TODAY","orderTime":["10301100","11001140"]}
                                                // var reg = new RegExp("%22", "g");
                                                // var dataJson = $.parseJSON(orderData.replace(reg, "\""));
                                                //
                                                //
                                                // var email = dataJson.email;
                                                // var password = dataJson.password;

                                                var email = "xxx@anu.edu.au";     //测试用
                                                var password = "123";     //测试用
                                                $.ajax({
                                                    type: "get",
                                                    url: "http://54.79.60.225:8080/user/get_usage_habit",
                                                    data: {
                                                        email: email,
                                                        password: password
                                                    },
                                                    async: false, // 要求同步
                                                    success: function (response) {
                                                        document.getElementById('address').innerHTML = response.data.address;//正确形式
                                                        document.getElementById('roomNumber').innerHTML = response.data.roomNumber;//正确形式
                                                        document.getElementById('houseType').innerHTML = response.data.houseType;//正确形式

                                                        document.getElementById('planId').innerHTML = response.data.planId;//正确形式
                                                        document.getElementById('companyName').innerHTML = response.data.companyName;//正确形式
                                                        document.getElementById('planName').innerHTML = response.data.planName;//正确形式
                                                        document.getElementById('tariffType').innerHTML = response.data.tariffType;//正确形式
                                                        document.getElementById('contractPeriod').innerHTML = response.data.contractPeriod + " year";//正确形式
                                                        document.getElementById('estimatedPrice').innerHTML = "$ " + response.data.estimatedPrice;//正确形式
                                                        if (response.data.planId !== null) {
                                                            document.getElementById('planID').setAttribute('value', response.data.planId);
                                                        }


                                                    }
                                                });


                                            });

                                        </script>


                                        <!--
                                        这一个大的div的数据都要改
                                        从后台获取，然后填入
                                        -->
                                        <div class="py-4">

                                            <p class="clearfix">
                                                <span class="float-left">Plan ID</span>
                                                <span class="float-right text-success" id="planId"></span>
                                            </p>

                                            <p class="clearfix">
                                                <span class="float-left">Retailor Name</span>
                                                <span class="float-right text-success" id="companyName"></span>
                                            </p>

                                            <p class="clearfix">
                                                <span class="float-left">Plan Name</span>
                                                <span class="float-right text-success" id="planName"></span>
                                            </p>

                                            <p class="clearfix">
                                                <span class="float-left">Tariff Type</span>
                                                <span class="float-right text-success"
                                                      id="tariffType"></span>
                                            </p>

                                            <p class="clearfix">
                                                <span class="float-left">Contract Period</span>
                                                <span class="float-right text-success" id="contractPeriod"></span>
                                            </p>

                                            <p class="clearfix">
                                                <span class="float-left">Estimated price</span>
                                                <span class="float-right text-success"
                                                      id="estimatedPrice"></span>
                                            </p>

                                        </div>
                                        <h4 class="card-title py-4">Summary</h4>
                                        <canvas id="barChart"></canvas>

                                        <script>
                                            var data = {
                                                labels: ["Daily", "Monthly", "Yearly"],
                                                datasets: [{
                                                    label: 'Energy usage',
                                                    data: [10, 71, 296],
                                                    backgroundColor: [
                                                        'rgba(255, 99, 132, 0.2)',
                                                        'rgba(54, 162, 235, 0.2)',
                                                        'rgba(255, 206, 86, 0.2)'
                                                    ],
                                                    borderColor: [
                                                        'rgba(255,99,132,1)',
                                                        'rgba(54, 162, 235, 1)',
                                                        'rgba(255, 206, 86, 1)'
                                                    ],
                                                    borderWidth: 1,
                                                    fill: false
                                                }]
                                            };
                                            var options = {
                                                scales: {
                                                    yAxes: [{
                                                        ticks: {
                                                            beginAtZero: true
                                                        }
                                                    }]
                                                },
                                                legend: {
                                                    display: false
                                                },
                                                elements: {
                                                    point: {
                                                        radius: 0
                                                    }
                                                }

                                            };
                                            // Get context with jQuery - using jQuery's .get() method.
                                            if ($("#barChart").length) {
                                                var barChartCanvas = $("#barChart").get(0).getContext("2d");
                                                // This will get the first returned node in the jQuery collection.
                                                var barChart = new Chart(barChartCanvas, {
                                                    type: 'bar',
                                                    data: data,
                                                    options: options
                                                });
                                            }
                                        </script>

                                    </div>
                                </div>


                            </div>
                        </div>
                    </div>
                    <!-- row end -->

                </div>
            </div>
                <!-- content-wrapper ends -->
                <!-- partial:./partials/_footer.html -->
                <footer class="footer">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-sm-flex justify-content-center justify-content-sm-between py-2">
                                <p class="text-center text-sm-left d-block d-sm-inline-block mb-0">Copyright © 2021 Energy
                                    Dash Team. All
                                    rights reserved.</p>
                            </div>
                        </div>
                    </div>
                </footer>
                <!-- partial -->
            </div>
            <!-- main-panel ends -->
        </div>
        <!-- page-body-wrapper ends -->
    </div>

<!-- base:js -->
<script src="../../vendors/js/vendor.bundle.base.js"></script>
<!-- endinject -->

<!-- inject:js -->
<script src="../../js/off-canvas.js"></script>
<script src="../../js/hoverable-collapse.js"></script>
<script src="../../js/template.js"></script>
<!-- endinject -->


</body>

</html>
